<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Spark Queries # To use Iceberg in Spark, first configure Spark catalogs.
Iceberg uses Apache Spark&rsquo;s DataSourceV2 API for data source and catalog implementations. Spark DSv2 is an evolving API with different levels of support in Spark versions:
Feature support Spark 3.0 Spark 2.4 Notes SELECT ✔️ DataFrame reads ✔️ ✔️ Metadata table SELECT ✔️ History metadata table ✔️ ✔️ Snapshots metadata table ✔️ ✔️ Files metadata table ✔️ ✔️ Manifests metadata table ✔️ ✔️ Partitions metadata table ✔️ ✔️ All metadata tables ✔️ ✔️ Querying with SQL # In Spark 3, tables use identifiers that include a catalog name."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Queries"><meta property="og:description" content="Spark Queries # To use Iceberg in Spark, first configure Spark catalogs.
Iceberg uses Apache Spark&rsquo;s DataSourceV2 API for data source and catalog implementations. Spark DSv2 is an evolving API with different levels of support in Spark versions:
Feature support Spark 3.0 Spark 2.4 Notes SELECT ✔️ DataFrame reads ✔️ ✔️ Metadata table SELECT ✔️ History metadata table ✔️ ✔️ Snapshots metadata table ✔️ ✔️ Files metadata table ✔️ ✔️ Manifests metadata table ✔️ ✔️ Partitions metadata table ✔️ ✔️ All metadata tables ✔️ ✔️ Querying with SQL # In Spark 3, tables use identifiers that include a catalog name."><meta property="og:type" content="article"><meta property="og:url" content="https://iceberg.apache.org/docs/latest/spark-queries/"><meta property="article:section" content="docs"><title>Queries | Apache Iceberg</title><link rel=manifest href=/docs/latest/manifest.json><link rel=icon href=/docs/latest/favicon.png type=image/x-icon><link rel=stylesheet href=/docs/latest/book.min.382d02a42babcef8e45d56616eebb5450770cf883b4185c7cbd5ecc4cb40920b.css integrity="sha256-OC0CpCurzvjkXVZhbuu1RQdwz4g7QYXHy9XsxMtAkgs=" crossorigin=anonymous><script defer src=/docs/latest/flexsearch.min.js></script>
<script defer src=/docs/latest/en.search.min.7f9807f68d72554758ec4bf61e9a871dceb7b6e6e462ce815e14eaa78d79c039.js integrity="sha256-f5gH9o1yVUdY7Ev2HpqHHc63tubkYs6BXhTqp415wDk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/docs/latest/../../><img src=/docs/latest/img/iceberg-logo-icon.png alt=Logo><span>Apache Iceberg</span></a>
<a href=https://iceberg.apache.org/docs/latest/../../releases><img id=version-shield src=https://img.shields.io/badge/version-0.13.2-blue alt></a></h2><div class=book-search><div class="book-search-spinner hidden"></div><a href=https://github.com/apache/iceberg target=_blank><img src=https://iceberg.apache.org/docs/latest/img/GitHub-Mark.png target=_blank class=top-external-icon></a>
<a href=https://join.slack.com/t/apache-iceberg/shared_invite/zt-tlv0zjz6-jGJEkHfb1~heMCJA3Uycrg target=_blank><img src=https://iceberg.apache.org/docs/latest/img/Slack_Mark_Web.png target=_blank class=top-external-icon></a></div><ul><li class=book-section-flats><span><i class="fa fa-table fa-fw"></i>
Tables</span><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/configuration/>Configuration</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/evolution/>Evolution</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/maintenance/>Maintenance</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/partitioning/>Partitioning</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/performance/>Performance</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/reliability/>Reliability</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/schemas/>Schemas</a></li></ul></li><li class=book-section-flats><span><i class="fa fa-star-o fa-fw"></i>
Spark</span><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/getting-started/>Getting Started</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-configuration/>Configuration</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-ddl/>DDL</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-procedures/>Procedures</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-queries/ class=active>Queries</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-structured-streaming/>Structured Streaming</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/spark-writes/>Writes</a></li></ul></li><li class=book-section-flats><span><img src=https://iceberg.apache.org/docs/latest/img/flink-logo.png class="navigation-icon fa-fw">Flink</span><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/flink/>Getting Started</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/flink-connector/>Flink Connector</a></li></ul></li><li class=book-section-flats><a href=https://iceberg.apache.org/docs/latest/hive/><img src=https://iceberg.apache.org/docs/latest/img/../img/hive-logo.png class="navigation-icon fa-fw">Hive</a><ul></ul></li><li><a href=https://trino.io/docs/current/connector/iceberg.html target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/trino-logo.png class="navigation-icon fa-fw">
Trino</a></li><li><a href=https://prestodb.io/docs/current/connector/iceberg.html target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/prestodb-logo.png class="navigation-icon fa-fw">
Presto</a></li><li><a href=https://docs.dremio.com/data-formats/apache-iceberg/ target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/dremio-logo.png class="navigation-icon fa-fw">
Dremio</a></li><li><a href=https://docs.starrocks.com/en-us/main/using_starrocks/External_table#apache-iceberg-external-table target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/starrocks-logo.png class="navigation-icon fa-fw">
StarRocks</a></li><li><a href=https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg.html target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/athena-logo.png class="navigation-icon fa-fw">
Amazon Athena</a></li><li><a href=https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-iceberg-use-cluster.html target=_blank><img src=https://iceberg.apache.org/docs/latest/img/../img/emr-logo.png class="navigation-icon fa-fw">
Amazon EMR</a></li><li class=book-section-collapsed><input type=checkbox id=section-56605d8e971a871885e28ee5142728bf class=toggle>
<label for=section-56605d8e971a871885e28ee5142728bf class="flex justify-between"><a role=button><i class="fa fa-handshake-o fa-fw"></i>
Integrations</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/aws/>AWS</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/jdbc/>JDBC</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/nessie/>Nessie</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-bf7b3283e3790c00c8caaa140299052b class=toggle>
<label for=section-bf7b3283e3790c00c8caaa140299052b class="flex justify-between"><a role=button><i class="fa fa-connectdevelop fa-fw"></i>
API</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/java-api-quickstart/>Java Quickstart</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/api/>Java API</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/custom-catalog/>Java Custom Catalog</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../javadoc/latest>Javadocs</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/python-quickstart/>Python Quickstart</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/python-api-intro/>Python API</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/python-feature-support/>Python Feature Support</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-7e66f1754ca5d93e20ecdc89df5b8b28 class=toggle>
<label for=section-7e66f1754ca5d93e20ecdc89df5b8b28 class="flex justify-between"><a role=button><i class="fa fa-users fa-fw"></i>
Community</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../community>Join</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../blogs>Blogs</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../talks>Talks</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../contribute>Contribute</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-87dda23e9104fe3231cee3bc88a2d754 class=toggle>
<label for=section-87dda23e9104fe3231cee3bc88a2d754 class="flex justify-between"><a role=button><i class="fa fa-object-ungroup fa-fw"></i>
Format</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../spec>Spec</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../terms>Terms</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../view-spec>View Spec</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-2e5d3f5f142758d8dd368e9c281dd08e class=toggle>
<label for=section-2e5d3f5f142758d8dd368e9c281dd08e class="flex justify-between"><a role=button><i class="fa fa-wrench fa-fw"></i>
Project</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../how-to-release>How to Release</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../how-to-verify-a-release>How to Release</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../multi-engine-support>Multi-Engine Support</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../roadmap>Roadmap</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../security>Security</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../trademarks>Trademarks</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-4ddb27a8612bc8118c0b36386905d332 class=toggle>
<label for=section-4ddb27a8612bc8118c0b36386905d332 class="flex justify-between"><a role=button><i class="fa fa-code-fork fa-fw"></i>
Releases</a></label><ul><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../latest>Latest</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../0.13.2>0.13.2</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../0.13.1>0.13.1</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../0.13.0>0.13.0</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../0.12.1>0.12.1</a></li><li class=navigation-icon-pad><a href=https://iceberg.apache.org/docs/latest/../../../releases>Release Notes</a></li></ul></li><li class=book-section-collapsed><input type=checkbox id=section-296746d27808aa768e500824aaf2adea class=toggle>
<label for=section-296746d27808aa768e500824aaf2adea class="flex justify-between"><a role=button><img src=https://iceberg.apache.org/docs/latest/img/../img/asf.png class="navigation-icon fa-fw">ASF</a></label><ul><li class=navigation-icon-pad><a href=https://www.apache.org/licenses/ target=_blank><i class="fa fa-external-link fa-fw"></i>
License</a></li><li class=navigation-icon-pad><a href=https://www.apache.org/security/ target=_blank><i class="fa fa-external-link fa-fw"></i>
Security</a></li><li class=navigation-icon-pad><a href=https://www.apache.org/foundation/thanks.html target=_blank><i class="fa fa-external-link fa-fw"></i>
Sponsors</a></li><li class=navigation-icon-pad><a href=https://www.apache.org/foundation/sponsorship.html target=_blank><i class="fa fa-external-link fa-fw"></i>
Donate</a></li><li class=navigation-icon-pad><a href=https://www.apache.org/events/current-event.html target=_blank><i class="fa fa-external-link fa-fw"></i>
Events</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/></div><div><ul id=book-search-results><li id=liFirst style=background-color:#0000;border-bottom:#0000;color:#0000>.</li></ul></div></br><header class=book-header><div class="flex align-center justify-between"><link rel=stylesheet href=/docs/latest/fontawesome/css/font-awesome.min.css><label for=menu-control><img src=/docs/latest/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Queries</strong>
<label for=toc-control><img src=/docs/latest/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#querying-with-sql>Querying with SQL</a></li><li><a href=#querying-with-dataframes>Querying with DataFrames</a><ul><li><a href=#catalogs-with-dataframereader>Catalogs with DataFrameReader</a></li><li><a href=#time-travel>Time travel</a></li><li><a href=#incremental-read>Incremental read</a></li><li><a href=#spark-24>Spark 2.4</a></li></ul></li><li><a href=#inspecting-tables>Inspecting tables</a><ul><li><a href=#history>History</a></li><li><a href=#snapshots>Snapshots</a></li><li><a href=#files>Files</a></li><li><a href=#manifests>Manifests</a></li><li><a href=#partitions>Partitions</a></li><li><a href=#all-metadata-tables>All Metadata Tables</a></li></ul></li><li><a href=#inspecting-with-dataframes>Inspecting with DataFrames</a></li></ul></nav></aside></header><article class=markdown><h1 id=spark-queries>Spark Queries
<a class=anchor href=#spark-queries>#</a></h1><p>To use Iceberg in Spark, first configure <a href=../spark-configuration>Spark catalogs</a>.</p><p>Iceberg uses Apache Spark&rsquo;s DataSourceV2 API for data source and catalog implementations. Spark DSv2 is an evolving API with different levels of support in Spark versions:</p><table><thead><tr><th>Feature support</th><th>Spark 3.0</th><th>Spark 2.4</th><th>Notes</th></tr></thead><tbody><tr><td><a href=#querying-with-sql><code>SELECT</code></a></td><td>✔️</td><td></td><td></td></tr><tr><td><a href=#querying-with-dataframes>DataFrame reads</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#inspecting-tables>Metadata table <code>SELECT</code></a></td><td>✔️</td><td></td><td></td></tr><tr><td><a href=#history>History metadata table</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#snapshots>Snapshots metadata table</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#files>Files metadata table</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#manifests>Manifests metadata table</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#partitions>Partitions metadata table</a></td><td>✔️</td><td>✔️</td><td></td></tr><tr><td><a href=#all-metadata-tables>All metadata tables</a></td><td>✔️</td><td>✔️</td><td></td></tr></tbody></table><h2 id=querying-with-sql>Querying with SQL
<a class=anchor href=#querying-with-sql>#</a></h2><p>In Spark 3, tables use identifiers that include a <a href=../spark-configuration#using-catalogs>catalog name</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span> <span style=color:#75715e>-- catalog: prod, namespace: db, table: table
</span></span></span></code></pre></div><p>Metadata tables, like <code>history</code> and <code>snapshots</code>, can use the Iceberg table name as a namespace.</p><p>For example, to read from the <code>files</code> metadata table for <code>prod.db.table</code>:</p><pre tabindex=0><code>SELECT * FROM prod.db.table.files
</code></pre><table><thead><tr><th>content</th><th>file_path</th><th>file_format</th><th>spec_id</th><th>partition</th><th>record_count</th><th>file_size_in_bytes</th><th>column_sizes</th><th>value_counts</th><th>null_value_counts</th><th>nan_value_counts</th><th>lower_bounds</th><th>upper_bounds</th><th>key_metadata</th><th>split_offsets</th><th>equality_ids</th><th>sort_order_id</th></tr></thead><tbody><tr><td>0</td><td>s3:/&mldr;/table/data/00000-3-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 01}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> c]</td><td>[1 -> , 2 -> c]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr><tr><td>0</td><td>s3:/&mldr;/table/data/00001-4-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 02}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> b]</td><td>[1 -> , 2 -> b]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr><tr><td>0</td><td>s3:/&mldr;/table/data/00002-5-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 03}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> a]</td><td>[1 -> , 2 -> a]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr></tbody></table><h2 id=querying-with-dataframes>Querying with DataFrames
<a class=anchor href=#querying-with-dataframes>#</a></h2><p>To load a table as a DataFrame, use <code>table</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>val</span> df <span style=color:#66d9ef>=</span> spark<span style=color:#f92672>.</span>table<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;prod.db.table&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><h3 id=catalogs-with-dataframereader>Catalogs with DataFrameReader
<a class=anchor href=#catalogs-with-dataframereader>#</a></h3><p>Iceberg 0.11.0 adds multi-catalog support to <code>DataFrameReader</code> in both Spark 3.x and 2.4.</p><p>Paths and table names can be loaded with Spark&rsquo;s <code>DataFrameReader</code> interface. How tables are loaded depends on how
the identifier is specified. When using <code>spark.read.format("iceberg").path(table)</code> or <code>spark.table(table)</code> the <code>table</code>
variable can take a number of forms as listed below:</p><ul><li><code>file:/path/to/table</code>: loads a HadoopTable at given path</li><li><code>tablename</code>: loads <code>currentCatalog.currentNamespace.tablename</code></li><li><code>catalog.tablename</code>: loads <code>tablename</code> from the specified catalog.</li><li><code>namespace.tablename</code>: loads <code>namespace.tablename</code> from current catalog</li><li><code>catalog.namespace.tablename</code>: loads <code>namespace.tablename</code> from the specified catalog.</li><li><code>namespace1.namespace2.tablename</code>: loads <code>namespace1.namespace2.tablename</code> from current catalog</li></ul><p>The above list is in order of priority. For example: a matching catalog will take priority over any namespace resolution.</p><h3 id=time-travel>Time travel
<a class=anchor href=#time-travel>#</a></h3><p>To select a specific table snapshot or the snapshot at some time, Iceberg supports two Spark read options:</p><ul><li><code>snapshot-id</code> selects a specific table snapshot</li><li><code>as-of-timestamp</code> selects the current snapshot at a timestamp, in milliseconds</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#75715e>// time travel to October 26, 1986 at 01:21:00
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>option<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;as-of-timestamp&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;499162860000&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;path/to/table&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#75715e>// time travel to snapshot with ID 10963874102873L
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>option<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;snapshot-id&#34;</span><span style=color:#f92672>,</span> <span style=color:#ae81ff>10963874102873L</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;path/to/table&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><blockquote class="book-hint info">Spark does not currently support using <code>option</code> with <code>table</code> in DataFrameReader commands. All options will be silently
ignored. Do not use <code>table</code> when attempting to time-travel or use other options. Options will be supported with <code>table</code>
in <a href=https://issues.apache.org/jira/browse/SPARK-32592>Spark 3.1 - SPARK-32592</a>.</blockquote><p>Time travel is not yet supported by Spark&rsquo;s SQL syntax.</p><h3 id=incremental-read>Incremental read
<a class=anchor href=#incremental-read>#</a></h3><p>To read appended data incrementally, use:</p><ul><li><code>start-snapshot-id</code> Start snapshot ID used in incremental scans (exclusive).</li><li><code>end-snapshot-id</code> End snapshot ID used in incremental scans (inclusive). This is optional. Omitting it will default to the current snapshot.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#75715e>// get the data added after start-snapshot-id (10963874102873L) until end-snapshot-id (63874143573109L)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>option<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;start-snapshot-id&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;10963874102873&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>option<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;end-snapshot-id&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;63874143573109&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;path/to/table&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><blockquote class="book-hint info">Currently gets only the data from <code>append</code> operation. Cannot support <code>replace</code>, <code>overwrite</code>, <code>delete</code> operations.
Incremental read works with both V1 and V2 format-version.
Incremental read is not supported by Spark&rsquo;s SQL syntax.</blockquote><h3 id=spark-24>Spark 2.4
<a class=anchor href=#spark-24>#</a></h3><p>Spark 2.4 requires using the DataFrame reader with <code>iceberg</code> as a format, because 2.4 does not support direct SQL queries:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#75715e>// named metastore table
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>).</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;catalog.db.table&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Hadoop path table
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>).</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;hdfs://nn:8020/path/to/table&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><h4 id=spark-24-with-sql>Spark 2.4 with SQL
<a class=anchor href=#spark-24-with-sql>#</a></h4><p>To run SQL <code>SELECT</code> statements on Iceberg tables in 2.4, register the DataFrame as a temporary table:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>val</span> df <span style=color:#66d9ef>=</span> spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>).</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;db.table&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>createOrReplaceTempView<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;table&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>spark<span style=color:#f92672>.</span>sql<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&#34;&#34;select count(1) from table&#34;&#34;&#34;</span><span style=color:#f92672>).</span>show<span style=color:#f92672>()</span>
</span></span></code></pre></div><h2 id=inspecting-tables>Inspecting tables
<a class=anchor href=#inspecting-tables>#</a></h2><p>To inspect a table&rsquo;s history, snapshots, and other metadata, Iceberg supports metadata tables.</p><p>Metadata tables are identified by adding the metadata table name after the original table name. For example, history for <code>db.table</code> is read using <code>db.table.history</code>.</p><blockquote class="book-hint info"><p>For Spark 2.4, use the <code>DataFrameReader</code> API to <a href=#inspecting-with-dataframes>inspect tables</a>.</p><p>For Spark 3, prior to 3.2, the Spark <a href=../spark-configuration#replacing-the-session-catalog>session catalog</a> does not support table names with multipart identifiers such as <code>catalog.database.table.metadata</code>. As a workaround, configure an <code>org.apache.iceberg.spark.SparkCatalog</code>, or use the Spark <code>DataFrameReader</code> API.</p></blockquote><h3 id=history>History
<a class=anchor href=#history>#</a></h3><p>To show table history:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.history
</span></span></code></pre></div><table><thead><tr><th>made_current_at</th><th>snapshot_id</th><th>parent_id</th><th>is_current_ancestor</th></tr></thead><tbody><tr><td>2019-02-08 03:29:51.215</td><td>5781947118336215154</td><td>NULL</td><td>true</td></tr><tr><td>2019-02-08 03:47:55.948</td><td>5179299526185056830</td><td>5781947118336215154</td><td>true</td></tr><tr><td>2019-02-09 16:24:30.13</td><td>296410040247533544</td><td>5179299526185056830</td><td>false</td></tr><tr><td>2019-02-09 16:32:47.336</td><td>2999875608062437330</td><td>5179299526185056830</td><td>true</td></tr><tr><td>2019-02-09 19:42:03.919</td><td>8924558786060583479</td><td>2999875608062437330</td><td>true</td></tr><tr><td>2019-02-09 19:49:16.343</td><td>6536733823181975045</td><td>8924558786060583479</td><td>true</td></tr></tbody></table><blockquote class="book-hint info"><strong>This shows a commit that was rolled back.</strong> The example has two snapshots with the same parent, and one is <em>not</em> an ancestor of the current table state.</blockquote><h3 id=snapshots>Snapshots
<a class=anchor href=#snapshots>#</a></h3><p>To show the valid snapshots for a table:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.snapshots
</span></span></code></pre></div><table><thead><tr><th>committed_at</th><th>snapshot_id</th><th>parent_id</th><th>operation</th><th>manifest_list</th><th>summary</th></tr></thead><tbody><tr><td>2019-02-08 03:29:51.215</td><td>57897183625154</td><td>null</td><td>append</td><td>s3://&mldr;/table/metadata/snap-57897183625154-1.avro</td><td>{ added-records -> 2478404, total-records -> 2478404, added-data-files -> 438, total-data-files -> 438, spark.app.id -> application_1520379288616_155055 }</td></tr></tbody></table><p>You can also join snapshots to table history. For example, this query will show table history, with the application ID that wrote each snapshot:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span>
</span></span><span style=display:flex><span>    h.made_current_at,
</span></span><span style=display:flex><span>    s.<span style=color:#66d9ef>operation</span>,
</span></span><span style=display:flex><span>    h.snapshot_id,
</span></span><span style=display:flex><span>    h.is_current_ancestor,
</span></span><span style=display:flex><span>    s.summary[<span style=color:#e6db74>&#39;spark.app.id&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> prod.db.<span style=color:#66d9ef>table</span>.history h
</span></span><span style=display:flex><span><span style=color:#66d9ef>join</span> prod.db.<span style=color:#66d9ef>table</span>.snapshots s
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>on</span> h.snapshot_id <span style=color:#f92672>=</span> s.snapshot_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> made_current_at
</span></span></code></pre></div><table><thead><tr><th>made_current_at</th><th>operation</th><th>snapshot_id</th><th>is_current_ancestor</th><th>summary[spark.app.id]</th></tr></thead><tbody><tr><td>2019-02-08 03:29:51.215</td><td>append</td><td>57897183625154</td><td>true</td><td>application_1520379288616_155055</td></tr><tr><td>2019-02-09 16:24:30.13</td><td>delete</td><td>29641004024753</td><td>false</td><td>application_1520379288616_151109</td></tr><tr><td>2019-02-09 16:32:47.336</td><td>append</td><td>57897183625154</td><td>true</td><td>application_1520379288616_155055</td></tr><tr><td>2019-02-08 03:47:55.948</td><td>overwrite</td><td>51792995261850</td><td>true</td><td>application_1520379288616_152431</td></tr></tbody></table><h3 id=files>Files
<a class=anchor href=#files>#</a></h3><p>To show a table&rsquo;s current data files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.files
</span></span></code></pre></div><table><thead><tr><th>content</th><th>file_path</th><th>file_format</th><th>spec_id</th><th>partition</th><th>record_count</th><th>file_size_in_bytes</th><th>column_sizes</th><th>value_counts</th><th>null_value_counts</th><th>nan_value_counts</th><th>lower_bounds</th><th>upper_bounds</th><th>key_metadata</th><th>split_offsets</th><th>equality_ids</th><th>sort_order_id</th></tr></thead><tbody><tr><td>0</td><td>s3:/&mldr;/table/data/00000-3-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 01}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> c]</td><td>[1 -> , 2 -> c]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr><tr><td>0</td><td>s3:/&mldr;/table/data/00001-4-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 02}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> b]</td><td>[1 -> , 2 -> b]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr><tr><td>0</td><td>s3:/&mldr;/table/data/00002-5-8d6d60e8-d427-4809-bcf0-f5d45a4aad96.parquet</td><td>PARQUET</td><td>0</td><td>{1999-01-01, 03}</td><td>1</td><td>597</td><td>[1 -> 90, 2 -> 62]</td><td>[1 -> 1, 2 -> 1]</td><td>[1 -> 0, 2 -> 0]</td><td>[]</td><td>[1 -> , 2 -> a]</td><td>[1 -> , 2 -> a]</td><td>null</td><td>[4]</td><td>null</td><td>null</td></tr></tbody></table><h3 id=manifests>Manifests
<a class=anchor href=#manifests>#</a></h3><p>To show a table&rsquo;s current file manifests:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.manifests
</span></span></code></pre></div><table><thead><tr><th>path</th><th>length</th><th>partition_spec_id</th><th>added_snapshot_id</th><th>added_data_files_count</th><th>existing_data_files_count</th><th>deleted_data_files_count</th><th>partition_summaries</th></tr></thead><tbody><tr><td>s3://&mldr;/table/metadata/45b5290b-ee61-4788-b324-b1e2735c0e10-m0.avro</td><td>4479</td><td>0</td><td>6668963634911763636</td><td>8</td><td>0</td><td>0</td><td>[[false,null,2019-05-13,2019-05-15]]</td></tr></tbody></table><p>Note:</p><ol><li>Fields within <code>partition_summaries</code> column of the manifests table correspond to <code>field_summary</code> structs within <a href=../../../spec#manifest-lists>manifest list</a>, with the following order:<ul><li><code>contains_null</code></li><li><code>contains_nan</code></li><li><code>lower_bound</code></li><li><code>upper_bound</code></li></ul></li><li><code>contains_nan</code> could return null, which indicates that this information is not available from the file&rsquo;s metadata.
This usually occurs when reading from V1 table, where <code>contains_nan</code> is not populated.</li></ol><h3 id=partitions>Partitions
<a class=anchor href=#partitions>#</a></h3><p>To show a table&rsquo;s current partitions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.partitions
</span></span></code></pre></div><table><thead><tr><th>partition</th><th>record_count</th><th>file_count</th></tr></thead><tbody><tr><td>{20211001, 11}</td><td>1</td><td>1</td></tr><tr><td>{20211002, 11}</td><td>1</td><td>1</td></tr><tr><td>{20211001, 10}</td><td>1</td><td>1</td></tr><tr><td>{20211002, 10}</td><td>1</td><td>1</td></tr></tbody></table><h3 id=all-metadata-tables>All Metadata Tables
<a class=anchor href=#all-metadata-tables>#</a></h3><p>These tables are unions of the metadata tables specific to the current snapshot, and return metadata across all snapshots.</p><blockquote class="book-hint danger">The &ldquo;all&rdquo; metadata tables may produce more than one row per data file or manifest file because metadata files may be part of more than one table snapshot.</blockquote><h4 id=all-data-files>All Data Files
<a class=anchor href=#all-data-files>#</a></h4><p>To show all of the table&rsquo;s data files and each file&rsquo;s metadata:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.all_data_files
</span></span></code></pre></div><table><thead><tr><th>content</th><th>file_path</th><th>file_format</th><th>partition</th><th>record_count</th><th>file_size_in_bytes</th><th>column_sizes</th><th>value_counts</th><th>null_value_counts</th><th>nan_value_counts</th><th>lower_bounds</th><th>upper_bounds</th><th>key_metadata</th><th>split_offsets</th><th>equality_ids</th><th>sort_order_id</th></tr></thead><tbody><tr><td>0</td><td>s3://&mldr;/dt=20210102/00000-0-756e2512-49ae-45bb-aae3-c0ca475e7879-00001.parquet</td><td>PARQUET</td><td>{20210102}</td><td>14</td><td>2444</td><td>{1 -> 94, 2 -> 17}</td><td>{1 -> 14, 2 -> 14}</td><td>{1 -> 0, 2 -> 0}</td><td>{}</td><td>{1 -> 1, 2 -> 20210102}</td><td>{1 -> 2, 2 -> 20210102}</td><td>null</td><td>[4]</td><td>null</td><td>0</td></tr><tr><td>0</td><td>s3://&mldr;/dt=20210103/00000-0-26222098-032f-472b-8ea5-651a55b21210-00001.parquet</td><td>PARQUET</td><td>{20210103}</td><td>14</td><td>2444</td><td>{1 -> 94, 2 -> 17}</td><td>{1 -> 14, 2 -> 14}</td><td>{1 -> 0, 2 -> 0}</td><td>{}</td><td>{1 -> 1, 2 -> 20210103}</td><td>{1 -> 3, 2 -> 20210103}</td><td>null</td><td>[4]</td><td>null</td><td>0</td></tr><tr><td>0</td><td>s3://&mldr;/dt=20210104/00000-0-a3bb1927-88eb-4f1c-bc6e-19076b0d952e-00001.parquet</td><td>PARQUET</td><td>{20210104}</td><td>14</td><td>2444</td><td>{1 -> 94, 2 -> 17}</td><td>{1 -> 14, 2 -> 14}</td><td>{1 -> 0, 2 -> 0}</td><td>{}</td><td>{1 -> 1, 2 -> 20210104}</td><td>{1 -> 3, 2 -> 20210104}</td><td>null</td><td>[4]</td><td>null</td><td>0</td></tr></tbody></table><h4 id=all-manifests>All Manifests
<a class=anchor href=#all-manifests>#</a></h4><p>To show all of the table&rsquo;s manifest files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> prod.db.<span style=color:#66d9ef>table</span>.all_manifests
</span></span></code></pre></div><table><thead><tr><th>path</th><th>length</th><th>partition_spec_id</th><th>added_snapshot_id</th><th>added_data_files_count</th><th>existing_data_files_count</th><th>deleted_data_files_count</th><th>partition_summaries</th></tr></thead><tbody><tr><td>s3://&mldr;/metadata/a85f78c5-3222-4b37-b7e4-faf944425d48-m0.avro</td><td>6376</td><td>0</td><td>6272782676904868561</td><td>2</td><td>0</td><td>0</td><td>[{false, false, 20210101, 20210101}]</td></tr></tbody></table><p>Note:</p><ol><li>Fields within <code>partition_summaries</code> column of the manifests table correspond to <code>field_summary</code> structs within <a href=../../../spec#manifest-lists>manifest list</a>, with the following order:<ul><li><code>contains_null</code></li><li><code>contains_nan</code></li><li><code>lower_bound</code></li><li><code>upper_bound</code></li></ul></li><li><code>contains_nan</code> could return null, which indicates that this information is not available from the file&rsquo;s metadata.
This usually occurs when reading from V1 table, where <code>contains_nan</code> is not populated.</li></ol><h2 id=inspecting-with-dataframes>Inspecting with DataFrames
<a class=anchor href=#inspecting-with-dataframes>#</a></h2><p>Metadata tables can be loaded in Spark 2.4 or Spark 3 using the DataFrameReader API:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#75715e>// named metastore table
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>).</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;db.table.files&#34;</span><span style=color:#f92672>).</span>show<span style=color:#f92672>(</span>truncate <span style=color:#66d9ef>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Hadoop path table
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>format<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;iceberg&#34;</span><span style=color:#f92672>).</span>load<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;hdfs://nn:8020/path/to/table#files&#34;</span><span style=color:#f92672>).</span>show<span style=color:#f92672>(</span>truncate <span style=color:#66d9ef>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>)</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#querying-with-sql>Querying with SQL</a></li><li><a href=#querying-with-dataframes>Querying with DataFrames</a><ul><li><a href=#catalogs-with-dataframereader>Catalogs with DataFrameReader</a></li><li><a href=#time-travel>Time travel</a></li><li><a href=#incremental-read>Incremental read</a></li><li><a href=#spark-24>Spark 2.4</a></li></ul></li><li><a href=#inspecting-tables>Inspecting tables</a><ul><li><a href=#history>History</a></li><li><a href=#snapshots>Snapshots</a></li><li><a href=#files>Files</a></li><li><a href=#manifests>Manifests</a></li><li><a href=#partitions>Partitions</a></li><li><a href=#all-metadata-tables>All Metadata Tables</a></li></ul></li><li><a href=#inspecting-with-dataframes>Inspecting with DataFrames</a></li></ul></nav></div></aside></main></body></html>